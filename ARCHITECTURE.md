# CI/CD Architecture â€” Diagrams and Flows

## ğŸ—ï¸ Global Architecture

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           LOCAL DEVELOPER                           â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚   cicd.ps1   â”‚ â†’  â”‚    Maven     â”‚ â†’  â”‚   GitHub      â”‚           â”‚
â”‚  â”‚   (Helper)   â”‚    â”‚   + Java 21  â”‚    â”‚   Packages    â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚         â”‚                    â”‚                    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                    â”‚                    â”‚
          â–¼                    â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           GIT REPOSITORY                            â”‚
â”‚                 github.com/tiogars/starter-api-spring-mysql         â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚   develop   â”‚  â”‚    main     â”‚  â”‚  v*.*.*     â”‚                  â”‚
â”‚  â”‚ (features)  â”‚  â”‚  (stable)   â”‚  â”‚  (release)  â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚         â”‚                â”‚                â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                â”‚                â”‚
          â–¼                â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            GITHUB ACTIONS                            â”‚
â”‚                         (Automated Workflows)                        â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  JOB 1: Build & Test                                      â”‚      â”‚
â”‚  â”‚  â”œâ”€ Setup Java 21                                          â”‚      â”‚
â”‚  â”‚  â”œâ”€ Configure Maven (GitHub Packages auth)                 â”‚      â”‚
â”‚  â”‚  â”œâ”€ Fetch dependencies from GitHub Packages               â”‚      â”‚
â”‚  â”‚  â”œâ”€ Compile (mvn compile)                                  â”‚      â”‚
â”‚  â”‚  â”œâ”€ Run tests (mvn test)                                   â”‚      â”‚
â”‚  â”‚  â”œâ”€ Package (mvn package)                                  â”‚      â”‚
â”‚  â”‚  â””â”€ Upload artifacts (JAR, test reports)                   â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â”‚                                                            â”‚
â”‚         â–¼                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  JOB 2: Create Release (tags only)                        â”‚      â”‚
â”‚  â”‚  â”œâ”€ Download build artifacts                               â”‚      â”‚
â”‚  â”‚  â”œâ”€ Create source archives (zip, tar.gz)                   â”‚      â”‚
â”‚  â”‚  â”œâ”€ Generate changelog from git history                    â”‚      â”‚
â”‚  â”‚  â””â”€ Create GitHub Release with attachments                 â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â”‚                                                            â”‚
â”‚         â–¼                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  JOB 3: Docker Build & Push                               â”‚      â”‚
â”‚  â”‚  â”œâ”€ Setup Docker Buildx (multi-platform)                  â”‚      â”‚
â”‚  â”‚  â”œâ”€ Login to GitHub Container Registry                     â”‚      â”‚
â”‚  â”‚  â”œâ”€ Extract metadata (tags, labels)                        â”‚      â”‚
â”‚  â”‚  â”œâ”€ Build image (amd64 + arm64)                            â”‚      â”‚
â”‚  â”‚  â”œâ”€ Push to ghcr.io/tiogars/starter-api-spring-mysql       â”‚      â”‚
â”‚  â”‚  â””â”€ Generate SBOM (CycloneDX)                              â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â”‚                                                            â”‚
â”‚         â–¼                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  JOB 4: Security Scan                                     â”‚      â”‚
â”‚  â”‚  â”œâ”€ Pull Docker image                                      â”‚      â”‚
â”‚  â”‚  â”œâ”€ Run Trivy vulnerability scanner                         â”‚      â”‚
â”‚  â”‚  â”œâ”€ Generate SARIF report                                   â”‚      â”‚
â”‚  â”‚  â””â”€ Upload to GitHub Security                               â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                â”‚                â”‚
          â–¼                â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ARTIFACTS & OUTPUTS                        â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ GitHub Releases â”‚  â”‚  Docker Images  â”‚  â”‚ Security Reportsâ”‚      â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚      â”‚
â”‚  â”‚ â€¢ JAR files     â”‚  â”‚ ghcr.io tags:   â”‚  â”‚ â€¢ Trivy scans   â”‚      â”‚
â”‚  â”‚ â€¢ Sources (zip) â”‚  â”‚ â€¢ latest        â”‚  â”‚ â€¢ SARIF format  â”‚      â”‚
â”‚  â”‚ â€¢ Changelogs    â”‚  â”‚ â€¢ v1.0.0        â”‚  â”‚ â€¢ GitHub Sec.   â”‚      â”‚
â”‚  â”‚                 â”‚  â”‚ â€¢ 1.0           â”‚  â”‚                 â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â€¢ 1             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                       â”‚ â€¢ develop       â”‚                            â”‚
â”‚                       â”‚ â€¢ main-sha      â”‚                            â”‚
â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Detailed Workflow

### 1ï¸âƒ£ Branch push (develop/main)

```text
Developer                GitHub Actions                 GitHub Registry
    â”‚                           â”‚                              â”‚
    â”‚ git push origin develop   â”‚                              â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                              â”‚
    â”‚                           â”‚                              â”‚
    â”‚                           â”‚ â‘  Build & Test               â”‚
    â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
    â”‚                           â”‚             â”‚                â”‚
    â”‚                           â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
    â”‚                           â”‚                              â”‚
    â”‚                           â”‚ â‘¡ Docker Build               â”‚
    â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                           â”‚         Push image           â”‚
    â”‚                           â”‚     (tag: develop)           â”‚
    â”‚                           â”‚                              â”‚
    â”‚                           â”‚ â‘¢ Security Scan              â”‚
    â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
    â”‚                           â”‚             â”‚                â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€ Notification â”€â”€â”€â”€â”¤<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
    â”‚      (success/fail)       â”‚                              â”‚
```

### 2ï¸âƒ£ Pull Request

```text
Developer                GitHub Actions                 Status Check
    â”‚                           â”‚                              â”‚
    â”‚ Create PR                 â”‚                              â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                              â”‚
    â”‚                           â”‚                              â”‚
    â”‚                           â”‚ â‘  Build & Test               â”‚
    â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                           â”‚    Report status             â”‚
    â”‚                           â”‚                              â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€ Status â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                              â”‚
    â”‚    âœ… All checks passed   â”‚                              â”‚
    â”‚    âŒ Tests failed        â”‚                              â”‚
    â”‚                           â”‚                              â”‚
    â”‚ (no Docker build on PR)   â”‚                              â”‚
```

### 3ï¸âƒ£ Release with Tag

```text
Developer          GitHub Actions      GitHub Releases    Docker Registry    Security
    â”‚                    â”‚                    â”‚                  â”‚              â”‚
    â”‚ git tag v1.0.0     â”‚                    â”‚                  â”‚              â”‚
    â”‚ git push --tags    â”‚                    â”‚                  â”‚              â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                  â”‚              â”‚
    â”‚                    â”‚                    â”‚                  â”‚              â”‚
    â”‚                    â”‚ â‘  Build & Test     â”‚                  â”‚              â”‚
    â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚                  â”‚              â”‚
    â”‚                    â”‚          â”‚         â”‚                  â”‚              â”‚
    â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚                  â”‚              â”‚
    â”‚                    â”‚                    â”‚                  â”‚              â”‚
    â”‚                    â”‚ â‘¡ Create Release   â”‚                  â”‚              â”‚
    â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚              â”‚
    â”‚                    â”‚   â€¢ JAR            â”‚                  â”‚              â”‚
    â”‚                    â”‚   â€¢ Sources        â”‚                  â”‚              â”‚
    â”‚                    â”‚   â€¢ Changelog      â”‚                  â”‚              â”‚
    â”‚                    â”‚                    â”‚                  â”‚              â”‚
    â”‚                    â”‚ â‘¢ Docker Multi-Tag â”‚                  â”‚              â”‚
    â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚              â”‚
    â”‚                    â”‚   â€¢ v1.0.0         â”‚                  â”‚              â”‚
    â”‚                    â”‚   â€¢ 1.0            â”‚                  â”‚              â”‚
    â”‚                    â”‚   â€¢ 1              â”‚                  â”‚              â”‚
    â”‚                    â”‚   â€¢ latest         â”‚                  â”‚              â”‚
    â”‚                    â”‚                    â”‚                  â”‚              â”‚
    â”‚                    â”‚ â‘£ Security Scan    â”‚                  â”‚              â”‚
    â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                    â”‚   Trivy scan       â”‚                  â”‚              â”‚
    â”‚                    â”‚                    â”‚                  â”‚              â”‚
    â”‚<â”€â”€â”€â”€ Notifications â”¤                    â”‚                  â”‚              â”‚
    â”‚   (Email/GitHub)   â”‚                    â”‚                  â”‚              â”‚
```

## ğŸ“Š Trigger Matrix

| Event           | Build & Test | Release | Docker Push               | Security Scan |
|-----------------|--------------|---------|---------------------------|---------------|
| Push (develop)  | âœ…           | âŒ      | âœ… (tag: develop)         | âœ…            |
| Push (main)     | âœ…           | âŒ      | âœ… (tag: main, latest)    | âœ…            |
| Pull Request    | âœ…           | âŒ      | âŒ                         | âŒ            |
| Tag (v*.*.*)    | âœ…           | âœ…      | âœ… (multi-tags)           | âœ…            |
| Manual          | âœ…           | âš™ï¸ (opt) | âœ…                         | âœ…            |

## ğŸ·ï¸ Docker Tagging Strategy

### For a tag `v1.2.3`

```text
ghcr.io/tiogars/starter-api-spring-mysql:v1.2.3   â† Exact version
ghcr.io/tiogars/starter-api-spring-mysql:1.2      â† Minor (receives patches)
ghcr.io/tiogars/starter-api-spring-mysql:1        â† Major (receives minors)
ghcr.io/tiogars/starter-api-spring-mysql:latest   â† Latest stable (main)
```

### For a branch

```text
ghcr.io/tiogars/starter-api-spring-mysql:develop        â† develop branch
ghcr.io/tiogars/starter-api-spring-mysql:main           â† main branch
ghcr.io/tiogars/starter-api-spring-mysql:main-abc1234   â† commit SHA
```

## ğŸ” Security & Permissions

### Tokens and authentication

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   GITHUB_TOKEN          â”‚  Provided automatically by GitHub Actions
â”‚   (automatic)           â”‚  Permissions: packages, contents, issues
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”œâ”€> GitHub Packages (Maven dependencies)
          â”œâ”€> GitHub Container Registry (Docker)
          â”œâ”€> GitHub Releases (Artifacts)
          â””â”€> GitHub Security (SARIF reports)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Personal Access Token â”‚  Local developer configuration only
â”‚   (developer)           â”‚  Permissions: read:packages
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â””â”€> Local Maven (~/.m2/settings.xml)
```

### Job permissions

| Job            | contents | packages | security-events | id-token |
|----------------|----------|----------|-----------------|----------|
| Build & Test   | read     | read     | -               | -        |
| Create Release | write    | read     | -               | -        |
| Docker Push    | read     | write    | -               | write    |
| Security Scan  | read     | read     | write           | -        |

## ğŸ“¦ Dependency Management

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Project dependencies            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                               â”‚
â”‚  Maven Central                                â”‚
â”‚  â”œâ”€ Spring Boot 3.5.7                         â”‚
â”‚  â”œâ”€ MySQL Connector                           â”‚
â”‚  â”œâ”€ SpringDoc OpenAPI                         â”‚
â”‚  â””â”€ [other public dependencies]               â”‚
â”‚                                               â”‚
â”‚  GitHub Packages (tiogars)                    â”‚
â”‚  â”œâ”€ architecture-create-service (1.0.2)       â”‚
â”‚  â””â”€ architecture-select-service (1.0.0)       â”‚
â”‚                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                        â”‚
         â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Maven Central  â”‚    â”‚ GitHub Packages  â”‚
â”‚  (public)       â”‚    â”‚  (authenticated) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Update workflow

The `dependency-check.yml` workflow runs automatically every Monday:

```text
Monday 9:00 UTC
    â”‚
    â”œâ”€> Check Maven Central updates
    â”œâ”€> Check GitHub Packages updates
    â”œâ”€> Check Plugin updates
    â”‚
    â”œâ”€> Generate report
    â”‚
    â””â”€> Create/Update GitHub Issue
            â”‚
            â””â”€> Labels: "dependencies", "maintenance"
```

## ğŸ¯ Workflow Summary

### ci-cd.yml (Main)

* Triggers: push, PR, tags, manual
* Jobs: 4 (build, release, docker, security)
* Duration: ~5â€“10 minutes
* Artifacts: JAR, Docker images, SBOM, reports

### dependency-check.yml (Maintenance)

* Triggers: schedule (weekly), manual
* Jobs: 1 (check)
* Duration: ~2â€“3 minutes
* Output: GitHub Issue

## ğŸš€ Entry Points

### Developer (Local)

```powershell
./cicd.ps1 setup      # Initial configuration
./cicd.ps1 build      # Daily build
./cicd.ps1 test       # Tests
./cicd.ps1 release    # Create a release
```

### DevOps / Release Manager

```bash
# Via GitHub interface
Actions â†’ CI/CD Pipeline â†’ Run workflow

# Via Git
git tag -a v1.0.0 -m "Release 1.0.0"
git push origin v1.0.0
```

### End user

```bash
# Docker
docker pull ghcr.io/tiogars/starter-api-spring-mysql:latest
docker run -d -p 8080:8080 ghcr.io/tiogars/starter-api-spring-mysql:latest

# JAR (from a release)
wget https://github.com/tiogars/starter-api-spring-mysql/releases/download/v1.0.0/starter-1.0.0.jar
java -jar starter-1.0.0.jar
```

---

Last updated: 2025-10-24  
Version: 1.0  
Maintained by: Tiogars
