# Architecture CI/CD - Diagramme et Flux

## ğŸ—ï¸ Architecture globale

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DÃ‰VELOPPEUR LOCAL                            â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚   cicd.ps1   â”‚ â†’ â”‚    Maven     â”‚ â†’ â”‚   GitHub     â”‚          â”‚
â”‚  â”‚   (Helper)   â”‚    â”‚   + Java 21  â”‚    â”‚   Packages   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚         â”‚                    â”‚                    â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                    â”‚                    â”‚
          â–¼                    â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           GIT REPOSITORY                             â”‚
â”‚                    github.com/tiogars/starter-api                   â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚   develop   â”‚  â”‚    main     â”‚  â”‚  v*.*.*     â”‚                â”‚
â”‚  â”‚  (feature)  â”‚  â”‚  (stable)   â”‚  â”‚  (release)  â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚         â”‚                â”‚                â”‚                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                â”‚                â”‚
          â–¼                â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        GITHUB ACTIONS                                â”‚
â”‚                      (Workflows Automatiques)                        â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  JOB 1: Build & Test                                      â”‚      â”‚
â”‚  â”‚  â”œâ”€ Setup Java 21                                         â”‚      â”‚
â”‚  â”‚  â”œâ”€ Configure Maven (GitHub Packages auth)               â”‚      â”‚
â”‚  â”‚  â”œâ”€ Fetch dependencies from GitHub Packages              â”‚      â”‚
â”‚  â”‚  â”œâ”€ Compile (mvn compile)                                â”‚      â”‚
â”‚  â”‚  â”œâ”€ Run tests (mvn test)                                 â”‚      â”‚
â”‚  â”‚  â”œâ”€ Package (mvn package)                                â”‚      â”‚
â”‚  â”‚  â””â”€ Upload artifacts (JAR, test reports)                 â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â”‚                                                             â”‚
â”‚         â–¼                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  JOB 2: Create Release (only on tags)                    â”‚      â”‚
â”‚  â”‚  â”œâ”€ Download build artifacts                             â”‚      â”‚
â”‚  â”‚  â”œâ”€ Create source archives (zip, tar.gz)                 â”‚      â”‚
â”‚  â”‚  â”œâ”€ Generate changelog from git history                  â”‚      â”‚
â”‚  â”‚  â””â”€ Create GitHub Release with attachments               â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â”‚                                                             â”‚
â”‚         â–¼                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  JOB 3: Docker Build & Push                               â”‚      â”‚
â”‚  â”‚  â”œâ”€ Setup Docker Buildx (multi-platform)                 â”‚      â”‚
â”‚  â”‚  â”œâ”€ Login to GitHub Container Registry                   â”‚      â”‚
â”‚  â”‚  â”œâ”€ Extract metadata (tags, labels)                      â”‚      â”‚
â”‚  â”‚  â”œâ”€ Build image (amd64 + arm64)                          â”‚      â”‚
â”‚  â”‚  â”œâ”€ Push to ghcr.io/tiogars/starter-api-spring-mysql    â”‚      â”‚
â”‚  â”‚  â””â”€ Generate SBOM (CycloneDX)                            â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â”‚                                                             â”‚
â”‚         â–¼                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  JOB 4: Security Scan                                     â”‚      â”‚
â”‚  â”‚  â”œâ”€ Pull Docker image                                     â”‚      â”‚
â”‚  â”‚  â”œâ”€ Run Trivy vulnerability scanner                      â”‚      â”‚
â”‚  â”‚  â”œâ”€ Generate SARIF report                                â”‚      â”‚
â”‚  â”‚  â””â”€ Upload to GitHub Security                            â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                â”‚                â”‚
          â–¼                â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ARTIFACTS & OUTPUTS                        â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ GitHub Releases â”‚  â”‚  Docker Images  â”‚  â”‚ Security Reportsâ”‚    â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚    â”‚
â”‚  â”‚ â€¢ JAR files     â”‚  â”‚ ghcr.io tags:   â”‚  â”‚ â€¢ Trivy scans   â”‚    â”‚
â”‚  â”‚ â€¢ Sources (zip) â”‚  â”‚ â€¢ latest        â”‚  â”‚ â€¢ SARIF format  â”‚    â”‚
â”‚  â”‚ â€¢ Changelogs    â”‚  â”‚ â€¢ v1.0.0        â”‚  â”‚ â€¢ GitHub Sec.   â”‚    â”‚
â”‚  â”‚                 â”‚  â”‚ â€¢ 1.0           â”‚  â”‚                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â€¢ 1             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                       â”‚ â€¢ develop       â”‚                          â”‚
â”‚                       â”‚ â€¢ main-sha      â”‚                          â”‚
â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Flux de travail dÃ©taillÃ©

### 1ï¸âƒ£ Push sur branche (develop/main)

```
Developer                GitHub Actions                 GitHub Registry
    â”‚                           â”‚                              â”‚
    â”‚ git push origin develop   â”‚                              â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                              â”‚
    â”‚                           â”‚                              â”‚
    â”‚                           â”‚ â‘  Build & Test               â”‚
    â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
    â”‚                           â”‚             â”‚                â”‚
    â”‚                           â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
    â”‚                           â”‚                              â”‚
    â”‚                           â”‚ â‘¡ Docker Build               â”‚
    â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                           â”‚         Push image           â”‚
    â”‚                           â”‚     (tag: develop)           â”‚
    â”‚                           â”‚                              â”‚
    â”‚                           â”‚ â‘¢ Security Scan              â”‚
    â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
    â”‚                           â”‚             â”‚                â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€ Notification â”€â”€â”€â”€â”¤<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
    â”‚      (success/fail)       â”‚                              â”‚
```

### 2ï¸âƒ£ Pull Request

```
Developer                GitHub Actions                 Status Check
    â”‚                           â”‚                              â”‚
    â”‚ Create PR                 â”‚                              â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                              â”‚
    â”‚                           â”‚                              â”‚
    â”‚                           â”‚ â‘  Build & Test               â”‚
    â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                           â”‚    Report status             â”‚
    â”‚                           â”‚                              â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€ Status â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                              â”‚
    â”‚    âœ… All checks passed   â”‚                              â”‚
    â”‚    âŒ Tests failed        â”‚                              â”‚
    â”‚                           â”‚                              â”‚
    â”‚ (NO Docker build on PR)   â”‚                              â”‚
```

### 3ï¸âƒ£ Release avec Tag

```
Developer          GitHub Actions      GitHub Releases    Docker Registry    Security
    â”‚                    â”‚                    â”‚                  â”‚              â”‚
    â”‚ git tag v1.0.0     â”‚                    â”‚                  â”‚              â”‚
    â”‚ git push --tags    â”‚                    â”‚                  â”‚              â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                  â”‚              â”‚
    â”‚                    â”‚                    â”‚                  â”‚              â”‚
    â”‚                    â”‚ â‘  Build & Test     â”‚                  â”‚              â”‚
    â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚                  â”‚              â”‚
    â”‚                    â”‚          â”‚         â”‚                  â”‚              â”‚
    â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚                  â”‚              â”‚
    â”‚                    â”‚                    â”‚                  â”‚              â”‚
    â”‚                    â”‚ â‘¡ Create Release   â”‚                  â”‚              â”‚
    â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚              â”‚
    â”‚                    â”‚   â€¢ JAR            â”‚                  â”‚              â”‚
    â”‚                    â”‚   â€¢ Sources        â”‚                  â”‚              â”‚
    â”‚                    â”‚   â€¢ Changelog      â”‚                  â”‚              â”‚
    â”‚                    â”‚                    â”‚                  â”‚              â”‚
    â”‚                    â”‚ â‘¢ Docker Multi-Tag â”‚                  â”‚              â”‚
    â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚              â”‚
    â”‚                    â”‚   â€¢ v1.0.0         â”‚                  â”‚              â”‚
    â”‚                    â”‚   â€¢ 1.0            â”‚                  â”‚              â”‚
    â”‚                    â”‚   â€¢ 1              â”‚                  â”‚              â”‚
    â”‚                    â”‚   â€¢ latest         â”‚                  â”‚              â”‚
    â”‚                    â”‚                    â”‚                  â”‚              â”‚
    â”‚                    â”‚ â‘£ Security Scan    â”‚                  â”‚              â”‚
    â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                    â”‚   Trivy scan       â”‚                  â”‚              â”‚
    â”‚                    â”‚                    â”‚                  â”‚              â”‚
    â”‚<â”€â”€â”€â”€ Notifications â”¤                    â”‚                  â”‚              â”‚
    â”‚   (Email/GitHub)   â”‚                    â”‚                  â”‚              â”‚
```

## ğŸ“Š Matrice de dÃ©clenchement

| Ã‰vÃ©nement | Build & Test | Release | Docker Push | Security Scan |
|-----------|--------------|---------|-------------|---------------|
| Push (develop) | âœ… | âŒ | âœ… (tag: develop) | âœ… |
| Push (main) | âœ… | âŒ | âœ… (tag: main, latest) | âœ… |
| Pull Request | âœ… | âŒ | âŒ | âŒ |
| Tag (v*.*.*) | âœ… | âœ… | âœ… (multi-tags) | âœ… |
| Manual | âœ… | âš™ï¸ (option) | âœ… | âœ… |

## ğŸ·ï¸ StratÃ©gie de tagging Docker

### Pour un tag `v1.2.3`

```
ghcr.io/tiogars/starter-api-spring-mysql:v1.2.3    â† Version exacte
ghcr.io/tiogars/starter-api-spring-mysql:1.2       â† Mineur (reÃ§oit patches)
ghcr.io/tiogars/starter-api-spring-mysql:1         â† Majeur (reÃ§oit mineurs)
ghcr.io/tiogars/starter-api-spring-mysql:latest    â† DerniÃ¨re stable (main)
```

### Pour une branche

```
ghcr.io/tiogars/starter-api-spring-mysql:develop           â† Branche develop
ghcr.io/tiogars/starter-api-spring-mysql:main              â† Branche main
ghcr.io/tiogars/starter-api-spring-mysql:main-abc1234     â† SHA commit
```

## ğŸ” SÃ©curitÃ© et permissions

### Tokens et authentification

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   GITHUB_TOKEN          â”‚  Fourni automatiquement par GitHub Actions
â”‚   (automatique)         â”‚  Permissions : read/write packages, contents, issues
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”œâ”€> GitHub Packages (Maven dependencies)
          â”œâ”€> GitHub Container Registry (Docker)
          â”œâ”€> GitHub Releases (Artifacts)
          â””â”€> GitHub Security (SARIF reports)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Personal Access Token â”‚  Configuration locale uniquement
â”‚   (dÃ©veloppeur)         â”‚  Permissions : read:packages
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â””â”€> Maven local (~/.m2/settings.xml)
```

### Permissions des jobs

| Job | contents | packages | security-events | id-token |
|-----|----------|----------|-----------------|----------|
| Build & Test | read | read | - | - |
| Create Release | write | read | - | - |
| Docker Push | read | write | - | write |
| Security Scan | read | read | write | - |

## ğŸ“¦ Gestion des dÃ©pendances

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         DÃ©pendances du projet                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                               â”‚
â”‚  Maven Central                                â”‚
â”‚  â”œâ”€ Spring Boot 3.5.7                        â”‚
â”‚  â”œâ”€ MySQL Connector                          â”‚
â”‚  â”œâ”€ SpringDoc OpenAPI                        â”‚
â”‚  â””â”€ [autres dÃ©pendances publiques]           â”‚
â”‚                                               â”‚
â”‚  GitHub Packages (tiogars)                    â”‚
â”‚  â”œâ”€ architecture-create-service (1.0.2)      â”‚
â”‚  â””â”€ architecture-select-service (1.0.0)      â”‚
â”‚                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                        â”‚
         â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Maven Central  â”‚    â”‚ GitHub Packages  â”‚
â”‚  (public)       â”‚    â”‚  (authentified)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Workflow de mise Ã  jour

Le workflow `dependency-check.yml` s'exÃ©cute automatiquement chaque lundi :

```
Monday 9:00 UTC
    â”‚
    â”œâ”€> Check Maven Central updates
    â”œâ”€> Check GitHub Packages updates
    â”œâ”€> Check Plugin updates
    â”‚
    â”œâ”€> Generate report
    â”‚
    â””â”€> Create/Update GitHub Issue
            â”‚
            â””â”€> Label: "dependencies", "maintenance"
```

## ğŸ¯ RÃ©sumÃ© des workflows

### ci-cd.yml (Principal)
- **DÃ©clencheurs** : push, PR, tags, manual
- **Jobs** : 4 (build, release, docker, security)
- **DurÃ©e** : ~5-10 minutes
- **Artifacts** : JAR, Docker images, SBOM, reports

### dependency-check.yml (Maintenance)
- **DÃ©clencheurs** : schedule (weekly), manual
- **Jobs** : 1 (check)
- **DurÃ©e** : ~2-3 minutes
- **Output** : GitHub Issue

## ğŸš€ Points d'entrÃ©e pour les utilisateurs

### DÃ©veloppeur (Local)

```powershell
.\cicd.ps1 setup      # Configuration initiale
.\cicd.ps1 build      # Build quotidien
.\cicd.ps1 test       # Tests
.\cicd.ps1 release    # CrÃ©er une release
```

### DevOps / Release Manager

```bash
# Via GitHub interface
Actions â†’ CI/CD Pipeline â†’ Run workflow

# Via Git
git tag -a v1.0.0 -m "Release 1.0.0"
git push origin v1.0.0
```

### Utilisateur final

```bash
# Docker
docker pull ghcr.io/tiogars/starter-api-spring-mysql:latest
docker run -d -p 8080:8080 ghcr.io/tiogars/starter-api-spring-mysql:latest

# JAR (depuis release)
wget https://github.com/tiogars/starter-api-spring-mysql/releases/download/v1.0.0/starter-1.0.0.jar
java -jar starter-1.0.0.jar
```

---

**DerniÃ¨re mise Ã  jour** : 2025-10-24  
**Version** : 1.0  
**Maintenu par** : Tiogars
